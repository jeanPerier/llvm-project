How to cherry-pick commits from f18-stage to llvm-project

Do once:
  git clone https://github.com/llvm/llvm-project.git $DIRECTORY
  cd $DIRECTORY
  git remote add f18-stage ssh://git@gitlab-master.nvidia.com:12051/fortran/f18-stage.git

To look for changes to merge from NVIDIA to LLVM:
  git fetch f18-stage # or --all
  git log f18-stage/master >log.tmp
  $EDITOR log.tmp nvidia-to-llvm.txt
# Look for new commits, add to log below
# Ignore merge commits and changes to cherrypicking.txt.

For each change to merge:
  git checkout main
  git pull
  git checkout -b $BRANCH
  git -c merge.renameLimit=1 cherry-pick -n $COMMIT
  git commit
# build and test
  if arc works
  then arc diff
  else git show HEAD >mydiff
       # load into phabricator
       git commit --amend # add "Differential Revision: <url>"
  fi
# set Subscribers: flang-commits and Tags: #flang
# get it approved in phabricator
  if arc works
  then arc land --hold $BRANCH
       git commit --amend # clean up the commit message
       git show -s # get the new HEAD commit number as $AMENDEDHEAD
       git push -- origin $AMENDEDHEAD:main
  else git push -- origin $BRANCH:main
  fi
  git checkout main
  git pull
  git checkout $BRANCH
  git rebase -i main # ensure that changes are now "no-op"
  git checkout main
  git branch -D $BRANCH

To do (oldest last):

In review:
7882a0071c6e4fe9e0bfac26edc611ae98bce844 whizard module file issues

Done (oldest last, omitting no-ops):
bd84c126df9467c8e37d41dd6088f13ab563be02 don't create HostAssocDetails symbols in derived type scopes
6485856881624f179e956e2373d7caa212178cbd classification of shape inquiries
1d622fe4d30847bfb78270ae00155410758b2f69 fix crash in folding (bug#48437)
dec36fefb3bec8f72a2087196ab8ad64cde2960f STORAGE_SIZE() & al.
4c2ca630fd1d6b8ae3d6f806bd95084bddf6cede fix bogus error for "p=>f()" array conformance
75046911802cd9e26f9d6629c93e2adba11d4985 clean up TODOs
7ec16c973cb9e36a6c38a73769fa598c10a776a6 fix list-directed REAL output
252fccb64d27ada4365e684342967695a9047095 + clang patches for...
145f0bbe938fa477218266723a9f3ce1d1f95a54 ... runtime tables
b8ae4c56e5a2570b4751c3b7cac89eb3b3a64133 improve initializer semantics
d7caeab6b416248f06cf44c4c686a5e6304943bd fix NULL pointer initializers
2cb85cef1097baac219c22da442656588f458c68 Unsplit COMPLEX
0e755edbc0eb29d98c6d2a069beb309921c79bfd DO CONCURRENT document
bc44d4826fa3fb9407af497c16f86d720b205f91 Val D.: fix missing provenance
bc50a56fa74b05a78d12c81531edd1ebd00ef13e END FILE
3ce5f957165d01b5123dfc62429f5ed1d1b6103d panicky patch for failed aarch64 build of f/r/allocatable.cpp
13a9b60141e2f01d8533cb3a97d0fd19a34b82a3 + patch for shared libs for ...
d93418558f68954e0dbfe3d310af6010aa387f2a ... fix CheckSpec.Expr w/ associations
a49a36416647c25dcb831ab364cc96bf47506f17 [msvc] replace some forward_list<>
8b24f3f99eeab2b85e64406c8df8c30405efb037 basic ALLOCATE/DEALLOCATE runtime
df91cd575ca60b863cebc229604cebe8d1989600 Val D.: labels on ENDs
0211380d6827a9b0b3bf802b986600675c0d844a IMPLICIT from scope of reference
11a700af38b87b29c71ced1a56927ea56d6f623c isnan
e16c0d6dc843fb75a1d74f0ba8686421bba9819b fix error recovery crash
43977591f07a213fc9d45e5123c60f1b876c2f45 FINAL pitfall warning
384462091bcc850c611d255bdbf16761df00e32b fix bad error message
ee73f451716c5a0cf30dd5204c7a062502841aae fix intrinsics actual arg char lengths
a81e73590c0a0e7154c63cbe58cf07f69072245b design doc for runtime table req'ts
41f150eff92462c6707abdb6826f82b4ee960fa9 ac implied DO indices are const exprs
e16c0d6dc843fb75a1d74f0ba8686421bba9819b plug error recovery hole
384462091bcc850c611d255bdbf16761df00e32b fix false error in...
0c4288b4b58fcc8d31b4b0500384f5de04ad0ea9 ... better errors for bad fwd refs
43977591f07a213fc9d45e5123c60f1b876c2f45 warn about FINAL pitfall
643c51aa7a84afe7a13b95ab79b3003fa549a50f rewrite ambiguous READ(CVAR)
86d91c271f790cca252cbd473993e261681752c0 allow "name:value" in !DIR$
930bd6cc9002221b71e6a1a84beb8534025ce85e whole assumed-size array usage
d2d626b2ab38d74f6751fc74ea2e6f1085ce987d TypeAndShape CHAR len tracking
e220d05f3f6bebc75ee266422065199022e2a133 correct kP scaling on F output edit
7b4222f5ef07ed6207e450211d8ca2030cd517ee correct binary->decimal buffer sizes
f231f308327698042a6ba2daf0d1e66297489f44 PAUSE with stop-code
554e34506694ae9babe84fe64242b45fc338d143 pad unformatted fixed-sized output
d479c9a99eaefac16bf54bf4fe47d1e66280a255 fix read->write transition in buffer
ae69ace3c66a6b71fbabc37717423cb50ebe5dd3 fix Kruse MSVC clang build breakage
75cf994910e378a7d0b860c9d20b7b246215d5e0 remove custom unsigned int const div
d235cfa38f1ee3e949c96f428603d00d6f44ebc7 fix WRITE after BACKSPACE
a8abdb0226b775f148ec7fc89e49b268d623053a fix INQUIRE access/formatting options
0f0820df3fe804d9bad958023e0ba2a7761e139e add checks (formatted in unf. I/O)
bc0d6562d878756beb1c4fb9f895743d4b5d55e4 fix Gw.d output edit cases
5bf42531cc9c84449d292e041b34281d007d4e1f fix / in external sequential READ
60535ce5082b559c8c2f87d630b2772c6d3daca9 FINAL semantics
f9c7d504bfb6f1640626e025737846642f8a8ae6 fix list-directed CHAR & LOGICAL array
4bfddefbb43c875dc7dec81fdb74af4f09cc0f34 + ...
a498ba8858f00ee962460637601d6342d22ebcd7 + pp fixes
a3e9d0ae1d5fac9ccc456b6ad21dc18882e45989 BZ mode in exponents
ef30acce6226d0ea82a9b2ae0289ae03ccc9ace2 #include "" ! comment
6ec065e18d9721c4016b1a903aea373c0e0f4e28 more CookedSource clean-up
9104b220740a822b0c3e0c24bfbb42f5a55a8a9d Val CARRIAGECONTROL
f4bc1435a6994bfaf65add1ed5ec597b81283446 multiple CookedSource instances
94398b3136e66fc534b6b682954b36b8a9bc1e17 deterministic dump output
0249414ff3cd1cc56d02614905698a3c6f9eaf60 better CASE integer typing
9418aedb1060010f0fad700a25dc20dcfacd1752 operand shape conformance checking
c81775fb03549c3c41feecbba12296f151ffeb93 shape conformance on initializers
9c8a452a959ac8e192f8830e2424b6a6aefcb769 make TypeParamInquiry monomorphic
92e34ce6fbd27e6ec6fc8c6b8b14e0f31dc10683 Val: label fix
2a0a8546ab20ae10aaa93d22064a7902fb3176fc Val: I/O vars must be definable
9a0729bef334363f4a3c8656e2c2322a7a3464ad better errors for bad chars
b96885a61ac50f28e8d226b68d5d2f72b763402c parse global compiler directives
bf0c51cda762f9230ae25b9560b09b79422839a8 don't left justify tokenization
a956f1d2e09dffc5468b7f68d5cf0898978008cc fix size in descriptor I/O
7ca7cb9cbbbfa38a2fd6c72b83f9f59bb02a044a shape(TRANSFER)
db41a84e6b0ddef75e823013174b1ea2be8f4612 fix mixed complex expressions
6d9cedd7031eddb0f1b04822953a52d5b54fd307 fix predefined macros
811fcb8af2dc46ca1861edc3f63d8a24c2cff677 PAD='YES' default
659ff2a3aac95903b83041f5738d8b902f2de88f Hollerith edge case
f769a9cd30a14f26e7cd830b3a4ccb018d88c321 Tim: fix warning in...
2a8050742abcbd4b849ce02c1b509b40d1dfbb07 DATA init with EQUIVALENCE
0a56419a5297ee1535fc776fe6fb2e31dbc10596 DATA init with Hollerith
80799e0ac6186955ab39ac98cd672c5990acea5c descriptor-based I/O
37414493d4e2fe6d191f9e02ab3628e30ca741e1 reformatting with latest clang-format
ad833c592eb0fb0b62556b3f046775226a086906 INQUIRE runtime
8b94d9abdfe47f39747e3c9dd965c35101775c9e defer "next input record" stuff
a1471e6303d8ef22afe4e81730e03c0e274dc453 file accessibility, size, positions
cf4f53ebf57e7f8085667f22720862fe1e7b0682 spaces in REAL input
da12a506b0c50d917cfa0ae75ba34825a3a1c602 remove RoundDefault enumerator
6cb7031500436edcf71db47499f41306994922ac pp tests (+ next)
1fd5e3377b1cfee4251d6321e50f9aec4a02cabd ... misplaced label check
64c63fc3bf2b22ea39731844990d342e0aabfe4f Allow no-comma FORMAT(1PE5.2)
a27b0abbeef9c2a4774a0050b6561be4a3624566 Add {Out,In}putComplex{32,64}
47215cfb52b6e09049029b9d8b5f41b565ae94c6 FORMAT reversion (2) +
226a109d9635290434e919a21bbe6d436bad480c FORMAT reversion (1)
fde8f0ea8a030fb509e627df9f97c3620931bb2a source continuation in macro calls
25d2c39f20e2f43ad156f9e8edcd84b9070a1979 byte-swapped unformatted I/O
68d420483aded068f6d96c6684aeb82240fd7d54 fix REAL formatted input case
1fd5e3377b1cfee4251d6321e50f9aec4a02cabd complain about misplaced labels
476ed2470cd9abd90972a7a7d1099a26ae8c6744 clean up STOP output
2fdc74ec2fef96dee8fdb3451b6e748da077147c fix Lw formatting
72461072df569694a33b3f1b41f9724fa16e457c fix bogus runtime error message
8a6a875d375d332843de6a083ebce423166e94c7 treat \t as ' ' in runtime input
c03be4e7414fff50d7c6cb7bac432f180f8a40b2 !DIR$ name=value
8548a3b66207186576883ad405b6cc0b804f92b4 allow comments on pp directives
63a783e08f79d606aebe510c60f4bab62438f763 rework r/w permissions on OPEN
16f03d4a4b778d13ebb28ddfb53045269c53a4a3 entries for scalar internal list IO
ce4dcd4ceb2ad77dc0bca991ad65c3f36231eadf fix fm923.f
499fdc0bfcd6d429ced29d629b09b9d08ea1f783 Anonymous external I/O units (fm401)
0917928b904cd7e63fc862901860dc3ce2d6971a Fix CR handling (fix) +
e25472e0d6bbe641a562927f53ef29c73c9d3673 ... fix CR handling (orig)
eb74a903396ff81dc23dcbd9c5dbc06dca528e86 Speed up real binary->dec
a52fdfdd9aebbefc61d3e664565ecc77322a47ac fix shared lib build
d95b91d77e1f40edfe7bf89eaea58fbe0744a39f fix unit number hash
60c58f58ba6048d0c1c5b1324d4b5bedc6dc9f73 Fix lowering bug #230
446c41b0c944fd9dff1d872c5c4459e8e9cbe53d Clean up runtime binary deps
9b8b332822221a409cc2e81b6fc3bd51a91cdb03 EQUIVALENCE fixes
acba890a16e6d2b26db1aefb5c17c9822f7ba26a Defer stmt func body analysis
dab72aa39d4c403adf4da5c819b32e4e9860c687 shape analysis of MATMUL
9ed81c9450a108357e21a0e82adca7070d6ddad1 fix F5.3 formatting of 0.025
831c6f18c405147ef36115e4239ce928ca78a165 DATA: processing & conversion to inits
008bd342b28bd46960b2214b58977f1bd4b473a0 DATA: remaining prep work
de3188d0c93ccf6850c0c9c0f7d21284ab30baeb DATA: initial images
7d8047a25f8bb2a07ba639d4d90caa11bb64bf42 DATA: designator folding
082c73c3467d7c02471fca9ec93167345c1856f0 roll-up small runtime fixes
21ea58e02d5aea966f5d393025d44d9ff56b0a95 fix osx build problems
049e7e5b79b357f3a4a24fbfdf2ce5d263f74ef2 + more CHARACTER runtime
cd2ce94f9c59d887ce84092d1eb970ade5fc32c4 Fix to IsDescriptor()
266e4b21f17b91d1a844ffa734af478df96d9038 Equivalence & common offsets
f5989ad96f2290e4d276a12c75591bb53be55b6c Add equivalence & common accessors
91585b69a235cc9cfe6bd7820544d2ea0b9b93a7 Fix x87 binary->decimal
baeff4139d3b6468790fb5ba999d74469d12f63d DATA statement rework
ed6d92af6bc65d917cd1243b314989a0017363d4 CHARACTER runtime

Not forwarded to LLVM:
6aa92cdec11af2369928e2bffda9401d5a1d8775 work around broken oot build
3216cf630345f4378783115b86cf89f68989091d Typed blobs
ab2dac0035620cf281871116cb5adeda49a26b52 fix build breakage
