How to cherry-pick commits from llvm-project into f18-stage

Do once:
  git clone ssh://git@gitlab-master.nvidia.com:12051/fortran/f18-stage.git $DIRECTORY
  cd $DIRECTORY
  git remote add llvm-project https://github.com/llvm/llvm-project.git

For each round of cherry-picking:
  git fetch llvm-project # or git fetch --all
  git checkout $BRANCH

If you want to see which files have diverged:
  git diff --name-status refs/remotes/llvm-project/master HEAD -- flang

To look for changes to merge from LLVM to NVIDIA:
  git log ${LATEST_CHERRYPICK_COMMIT}..llvm-project/master -- flang >log.tmp
  $EDITOR log.tmp llvm-to-nvidia.txt

Look for new flang commits since the latest (top) entry in the log below.
Add them to the "Commits to be cherry-picked" list below
(or "Not cherry-picked" if you think they should not be).

For each commit that you want to pick:
  $EDITOR llvm-to-nvidia.txt
  git cherry-pick -x $COMMIT
  # If the commit modifies files outside f18 (e.g., llvm/* & mlir/*),
  # the cherry-pick will fail.  Use "git rm -r -f llvm" or "mlir"
  # to clean up, then "git cherry-pick --continue".

Build and test.  If successful, move the newly picked commits
to the "Log of cherry-picked commits" list below.
  $EDITOR llvm-to-nvidia.txt
  git add llvm-to-nvidia.txt
  git commit -m '...'
  git push

Create a merge request for your branch.

To see a description of a commit without its diff:
  git show -s $COMMIT

The out-of-tree build & test of these changes was conducted
with llvm-project commit fad31d60329b4573a27aaf10cfe3174407d75c3a

Log of cherry-picked commits in reverse order (latest first):
19d7cc2e83061050923057abf72ab860bdc0a3b5 Pete: char literal substring fix
8199cd8a550dab8f9b4035d34b7e576892daab09 Michael K.: hack f18-parse-demo
18e9482e44ed2b59008a8a3b05c6c49ef0243b6d Michael K.: hack f18 driver for msvc
62ef1cb2079123b86878e4bfed3c14db448f1373 Michael K.: remove default args
e3d38b7b88989835d11b9d134482c17655b5a65d Michael K.: windows thing
f5e4451e1f27e87d30c4eb0c3c99f2f8d07039e1 Tim: intrinsics as arguments
2fc86ccdd25309b9f77739aaed4a7b06f1c6f111 sameeran: SPHINX
cf715717aa8cb17d98177af3ce63c7e20e8d25a3 Tim: Allow directives more places
16c1d251c4ce59f97802ff0c27ed6441f3153ab1 Valentin: use TableGen (take #2)
a9795b6f639f976e2d6f690066c61f890eed534f Tim: disable -Wmaybe-uninitialized
3b3dc1dbfffc6a710565bc83a46cee9a1334f32a Valentin: revert...
bf93edc4758b512e84b70ec6335d15b0cf386a18 Valentin: use TableGen
7f5928ef5a5743ee7e65c6c9d1e1c9bc6af03063 Tim: cascading error
89a9db438f85c6d4c0f11ecd0448bb71e1deac24 Camille: version info
82fd1392016984c81c6037e147ee2dd36cf91f4c River: mlir
1d6a8deb41221f73c57b57fe9add180da34af77f River: mlir
cf03bcf92922c483e1ecd4691263e01d14557c3e Tim: remove CMAKE_CXX_FLAGS
d8713523a2f5847ca69c8ef172578a915c129fe8 Tim: improve error message
0fc34520e0783945a872070412c8937852977eeb Michael Kruse: msvc
72243a25154277afcd475a01c8a77e2da554a0ce Tim: IMPLICIT NONE control options
7ae718f2437617fbe929248edab3dd6d67a3b606 Irina: OMP allocate clause
91ca2152b285c3a711b3e4baf1547fa688df90ee Tim: Fix warning
f837754df738797c90132d6b3c4dce0fffb59374 Valentin: OMP+OACC structure check
0cdb6b3f945cda44dede008487d81165480e6a6d Andrzej: fix multi-config builds
0799a6836564bd9bfe5fba2d66542123837abfb5 Rahul: mlir
6903d21bc5731fb1b4c59e60486e212d602a13d6 me: formatting
2c0abc125f046602a3f51da0a398a82953f2fa11 Tim: don't set INTRINSIC on dummy
594dec2884a4814dc97ebdfa7c83ef15bdfb379e inderjeet: Fix SELECT TYPE
2a6c8b2e9581ebca4b05d1e64458f2dccf3db61f River: refactor pass registration
bf812c145ca2edc4fb76133ec8104267d66f8ee6 Sourabh: OMP lowering
b752a8ca499b84d46c5b710f7a3b475fdf0d752e sameeran: C781
8830f1170dae898d7a0d6a95897e1c23e316ec1e sameeran: C7110-C7115
49660234db94faf54c2d0ffa150841b9b52671c9 sameeran: C7110-C7115
30e45f339eb0841dc7fe27fad119cc5db0c052f3 Barton: temp driver
b068d19a151d9d3a73b0265df27836d9fd0ad1e3 Barton: temp driver
dd5ea5674b86bade4904fab4c66a1156b3df033e Barton: temp driver
a50cec71ecea5680c15752d211db16d49d5b1f12 Jean: CMPLX folding
2cf52504bb076d24c23f161e92340828052b69f7 Pete: RESHAPE
fac84536bcb9fbca2b3517ca83d382329d0e6c55 Pete: fix assert
38272f45fed3f2233d54ff1495a4433f87215667 Tim: HostAssoc symbols
67e41df4e03e934b2990cd7f0b7f5d4e0a58e14f Jean: expose intrinsic mapping
2c662f3d3d957365ad86f35eee0bea05e4cf0188 Tim: intrinsic in type decl stmt
9500d48de367d969dc944445297ae5bdfaa14079 Tim: name reso rearrangement
ca0bf440dbf9977340db4a32ba61740930c2be03 Camille: temp driver
4a4cafabc9067fced5890a245b03ef5897ad988b Alexis: temp driver
ff25b2da2ab9049e154cc8b9af06a24f79a74209 Val C.: OACC name resolution
7454acdf3b7d064ebbf6b8027296f42f504b285a Tim: stmt func implicit decls
4ef2e594d5be2e0e6d4446c8082b15466bc7ffcb Truby lit thing
412056e2d02fae43c6e7c8511c650e8458d55701 Tim: convert stmt func result
aca58ef7840b2181bf80ffafe8a5187049ba7413 Val C. header comment
83dca19c11236700d26ebd1ecff65e01876c1e9d Pete: BOZ in relations
9e4ab439c2ee415ef0f7b873ac25bbc63c2a4657 Sourabh: OMP taskyield
b27ab9ce744fdf99902e3f7b09cf4f9407a340a0 Val C. OACC lowering
3b8ffdec0772e038056903ab3e30019bdb9a8b8d Val C. OACC fix
77e0e9e17daf0865620abcd41f692ab0642367c4 Logan's 3rd try
f72106e2a35b12ef4bb265e755a6ee33a576c768 Pete RESHAPE
afa1afd4108d973e059e5f5ad68cf01efe7985da bump up minimum cmake version
c6cb726a8c60d97908016fe7fb76cdc88b543db2 format replay (test)
320389e849f82403049c76ef06d11bfcef7b82e3 continuation in macro call (test)
8f2c5c4314f2360bf35d54507a54a5b612a41082 formatting difference
cf2274b779f5ffee476cfe40994e6963a51c6428 me: pp dir comments (test)
079b49b3fb22b9f1f7dfd9b18ab0179d0ad7e158 Sourabh@AMD: OMP taskwait
2e046be90e51df4978a72fb1665493ed3f57882e Rahul J.: mlir thing
920e127e02531640204be0944a37bd3bf449f66b Truby: add dependence
1c93671e594d075cb0008dc4f33d863611af9ab9 Truby: fix shared build for Lower
d4b1a14f0a6f6c330dbd0f1aca281d27034307c2 Kiran@AMD: OpenMP taskwait
fa5e4482e01f7eceae52529edb75e754b601e8d0 Tim: don't USE-associate intrinsics
b297563a751ec390d895c6ac4430e37c5efbb340 Tim: fix bare SAVE
9aa3dca80f5cfb67640d53998673ad636ac8b4c9 Val C.: OpenACC 3.0 semantics
8dbc86adf3e4da2ea284955ede94a0b30acc6d36 formatting
0c64cb6d08964b576cd95f5532ea4016fcd27943 Pete crash fix w/ array c'tors
02c3f70b47b81d8055adcf6cacc0456f13fde357 Alexis: F18_FC=gfortran
0a90ffa77293e8e2c99843f770cc0f2cd1d8947c Val C.: OpenACC 3.0 parsing
3d0b76022df60a8ceaa2198012d67eab3ec3a2d9 Sourabh @ AMD: OpenMP lowering
f06ad9134722cf090bc301ac8bf41a2a381f137e reversion of OpenAcc 3.0
65049d16100af360674659fb56e8f9bec96a0836 Val C.: OpenACC 3.0
f630b8590f0c541ccc8133d84f9464c2b469dda3 Alexis driver changes
3780d3eb1001fd25d4b4cf953ae621a0f3b30ee5 Tim: octal escapes in modules
4121172239779ea509908a2a57278a3d2206ad92 Truby add header
6e42a417bacbfd5a1f58b0ccb7c9b34ff9e54523 Val C.: clause checking OpenMP
9263e08251ae7ab6feaa6cda37d70fbd6971cfc4 Eric warning fix
85d9745c83a105692a8784b8c8a83482696b4900 Pete crash fix generics
7cd1b0ff347d7aa4864624501efbe2ac609e67d7 Eric partial revert
9520b6c8ab63061e1734deef8614eaa60f704dc9 Pete crash fix
c54a013e5a8206645e2611974ff83d19d74accbe Eric partial revert
24b62f28c5daa293a2602712e1eba82cb59f3a6f Eric intrinsic call lowering
15fa287b64d0ef845201339994cdf6eb3e4d51e1 Pete: image selectors
2ebf4b6e4c35c93c97da9ed14db7b38757c0d7f9 Isuru: mxcsr fix
4b9b64d561e952e64288cdec3bae1952269c1bcf Zach I/O runtime
c6a23df691fbfb1330d1fef71a4ac8b453b62a87 Kate R. num_images()
216a54a04b9b25fe6d1bcf7f516befd87bc0d976 Eric I/O lowering
cd503166fb74baf91c55f5f959ed9cd016cbd9f7 Kiran@AMD OpenMP flush
1b183918184ecbcd03898badf8d1789ea0f4ffe4 Tim missing include
f9e24a563c36fc98860f4b282af5f6d034b2863c Pete fix
a39e9cf6bec4e7c8e2e947972421c1d5a6f473d6 tidying ext. I/O change
98d576c78f88b6d7191335c9774313c191ef7539 tidying ext. I/O change
35808ab8e18cea0a668ea91786a3d916618e986e Eric: FIRBuilder.cpp
eb305631bec6bf6765c44dcfbb7ec9e8eca41be4 Jean: pgmath
70f2bcc197ebc8d1c77c5efd5b822a9c9ccdccc4 Tim: alt return fix
5c02a2421b951a14d1294598d0082b32659c7082 Eric: inliner
ffa1f8198e6e8be6ca1044975a67e646188210da Eric: tablegen
2ddba3082ca79080b14f372ebe4b5bdbc5f694ed Val C. use llvm/Frontend OMP stuff
05756e6937d58c357b0b7e37ff3e9a8f7dd0d485 Tim: alt returns
dd904082625b4fd83f90647952dabee93ef5e990 Tim: formatting
5a580bbb818737dcbfcfc2089532c38b670ef204 Eric: Runtime.h
f625f5231ab8e76b1367f70aeed56b6389d83471 mlir thing
98202edacbad2370105b8a5b837ad35569d7a387 Tim: clang-tidy silencing
bd2c3014e120949c4acc1d107ac71c4091f00a3d Eric: coarray hooks
b537c81b5fde154062ecf7521d41902b130dffe6 Barton: testing churn
ae74252341a0e985a3b637c9b6c30aed9b6f033b Barton: testing churn
bf57fc1c8ea3d8eaf2e9974691012767ac71a73e Barton: testing churn
66c26d93b7be0e1cbd5e1c7615a0f591c975fd27 Barton: testing churn
9c98ed9cd41fc6662a5e90037f25cb3a80658b74 Barton: testing churn
4198874630be5c6126d78944f8a2d89dea90c7c4 LLVM_ATTRIBUTE_UNUSED
c3477c51e5995983b9f837c1cd9e7528a5b1bdb2 Eric: CHARACTER work
84f380580531d4f44fb3e4a2d17b5033e1e9bb0b Eric: add RTBuilder.h
a9c478acd090bfdb162573af09e777571f8ae1d7 Eric: MLIR .clang-tidy
663860f63e73518fc09e55a4a68b03f8027eafc8 Tim: fix SAVE checking
3a84d84adcd59e62f37792b1f2c6859fb84971cd Eric: finish AbstractConverter
fa5d416efdcbdba766c0c9bd0797bd4b8bbe0273 sameeran: fix lit testing
b938eaec55b0d724de5a7d123364968df60c9c1f Eric: add BoxValue
b5d51c24488b5955700f29e40cfb4c5fb4241f76 Eric: add SymbolMap
3ed2909feb34e5b68c6272def7d445a7ca4c5c6f Pete: fix crash alternate returns
f1fa3b7f6ee958ec4dfb7104bd0ae64ec0061551 Jean: AMAX0 &c. rewrite
b46e2548b67de40acf33b5dde95077698995576f Eric: fix build
30db1776935ef921314937313fe9ec9dac48b693 Eric: Mangler module
93f602b339f62e058ce2c212c86f9f0ca3b20126 sameeran: google unittests
4741835e031b559f2effcad70f59e35c32c1eece Eric: fir.do_loop helper class
bb2f6f66c7f3189a3f9d2ea22ed9be6a3b8f5458 Pete: test for spec exprs
70ad73b6b76838bd7c72123922102b175e5d478a sameeran: select type
8bba0bca721d66a63709d427ff1e3b48cf7c2cad Eric: complex expr helper class
a27d3852095a461b739da534ddc9abfb625f2e06 Tim: Type def'n name res. bug fix
bb73d1b278eb478ca8e56153cf1469bf7eb13a3f Isuru: Fix missing config.h
3862cbbc652be3dd731e75500f971e21d8355462 Isuru: "Use LLVM's flags"
4d8c00c0595b6998e41373afadaaca3f51ae2cf8 Pete: fix crash on erroneous exprs
1746c8ed2660c83895c79de94453f44f8e729a94 Pete: fix crash: forward-ref'd len
baa12ddb6fa6840c1125f0aa11cd0e05fe82385d Eric: type conversions
38674030c026b6ba432dc81440bd3790d94b7c48 Val C.: Better WAR for gcc warning
3d9bb031d13c884122a5da456659e47dd52ec1f7 Val C.: dodge buggy gcc warning
62b127eef6b37a57a647050b0e123f6ac928215f Jean: IsConstantExpr fix
70f1b4b4122088c1bd7324b519bc449dbfeaf298 Anchu: DATA statements
81bf1e29aae5992db318803ba4722a585ad64638 Truby: release build flags
ae6e499d258c24fde433d02793c327367c402d50 Eric: OpenMP lowering stubs
fbac9ce226d7a27e418fdeac72a0b3c9f2c48742 Eric: PFT
c4dbe59ae8253d73b63e5fcce0bc8bc44b4d07b5 Pete: declaring procedure entities
38095549c6a12a75794595464fa9b95f5c6dcf35 Pete: C751-C760 D/79798
b1ae13b4e9798ecfe8803513490b9034bda2e693 mlir build fix
4ead2cf76c4a1df260e7dff0fa767074bae6e2b8 mlir D/69940
85725a67c745cb833174a7eae2aa53e74753bcb1 clementval: openmp D/77821
661b234cbcfb0195fb998b86815e89895b38b88a mlir D/79517
6f300105d21e1f3bf7f0f92c2564c29f0cab8fb9 Tim: Fix IMPORT bug D/79737
99aa87a5b5371b3c06480e3ff99dcc4f2adf2c2a Tim: testing scripts D/79634
63a4fdda8c33174dc9fc80fed385df759abbf14f Fix build D/79723
b05c8c5756e473e9ec51ed65869f6ed42c552404 Tim: ass't conversions D/79637
332e6aea37a2777c06eb7d0960edf33b5869b0de sameeran: SELECT RANK D/78623
5eae715a3115be2640d0fd37d0bd4771abf2ab9b mlir D/79463
cc4768f2ec7ca1e6421c18afeface61376e9fab7 sameeran: documentation
7ccc7e56724974a27c8ada44f3cf0be0b5b1f4c2 Tim: fix IsDescriptor
54b35c066417d4856e9d53313f7e98b354274584 Tim: align -> alignment
07b69dcf66776a6a340c5b1b49ca8a36e712026d Pete: message edited again
cfce9b67609f4d2c91ac9c6ab51931769903a560 Pete: message edited
0195b3a9098eba9349f4291606581669b2bef548 Tim fixes testing in standalone build
8d0c3c05f2f4b9e827eff98b7a375d174a163570 Pete: C741-C750
f432154d1bcfd61c9a8fcef9559917696fa09233 LLVM_LINK_COMPONENTS
1165a35a7312ccd723bbe3e5fe95cd3a3109ec66 IndexedAccessorRange

Not cherry-picked (omitting no-ops):
0057532e3f45508bd9aa2115948afee5859ed70c Barton: revert Camille's 89a9db438f85c6d4c0f11ecd0448bb71e1deac24
765b81f6b93f747bbca57e9042bdd3ce9fea5c5b Tim: revert Truby breakage...
332170356e35ea9cdc2c1d612b61a50ec5ea322e Truby: break OOT builds
9017b9ce1a14b578fc5162897b49c440b3d4fa4c Isuru: cripple -Werror
9362698450d1843e7fde98d8012a7308244c2d79 Truby: change DIE to llvm_unreachable
89c7d9633b3f2255ed711522f29751566a6f5d70
a1726e65bc1fdbd2800839e48e68cb4a68cc7092
